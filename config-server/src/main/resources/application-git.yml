# GIT Profile - Uses GitHub Repository (for Production)
# This profile reads configurations from a Git repository
#
# To use this profile:
# SPRING_PROFILES_ACTIVE=git
#
# Config Refresh Behavior:
# - Config is cached after initial clone/startup
# - Config is refreshed ONLY on:
#   1. Service restart (clone-on-start: true)
#   2. Explicit /actuator/refresh call (triggered by CI/webhook)
# - force-pull: false ensures no implicit Git pulls on normal config reads
# - This prevents silent staleness while maintaining performance

spring:
  cloud:
    config:
      server:
        git:
          uri: ${CONFIG_REPO_URL:https://github.com/your-org/config-repo}
          default-label: ${CONFIG_GIT_BRANCH:main}
          clone-on-start: true
          timeout: 10
          # CRITICAL: Must be false in production
          # When false: Config is cached, refreshed only on restart or /actuator/refresh
          # When true: Every config read triggers Git pull (performance issue, not recommended)
          force-pull: ${CONFIG_GIT_FORCE_PULL:false}
          search-paths: ${CONFIG_GIT_SEARCH_PATHS:{application}}
          username: ${GIT_USERNAME:}
          password: ${GIT_PASSWORD:}

management:
  endpoint:
    health:
      config:
        # Health check enabled but will not fail on Git slowness
        # Only fails if Config Server itself is unhealthy
        enabled: true
  info:
    git:
      enabled: true

logging:
  level:
    root: INFO
    org.springframework.cloud.config: INFO
    org.springframework.cloud.config.server: INFO
